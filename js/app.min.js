(()=>{"use strict";let e=!1;setTimeout((()=>{if(e){let e=new Event("windowScroll");window.addEventListener("scroll",(function(t){document.dispatchEvent(e)}))}}),0),window.addEventListener("load",(function(){document.querySelector("body")&&setTimeout((function(){document.querySelector("body").classList.add("_loaded")}),200)})),sessionStorage.getItem("preloader")&&(document.querySelector(".preloader")&&document.querySelector(".preloader").classList.add("_hide"),document.querySelector(".wrapper").classList.add("_visible")),sessionStorage.getItem("money")||sessionStorage.setItem("money",1e3),document.querySelector(".check").textContent=sessionStorage.getItem("money"),document.querySelector(".game")&&(d("bomb"),d("anvil"),d("circle")),document.querySelector(".mini-game")&&(document.querySelector(".footer__coins").textContent=50,sessionStorage.setItem("current-bet",50));const t=document.querySelector(".preloader"),s=document.querySelector(".wrapper");function o(e,t){document.querySelector(e).classList.contains(t)?document.querySelector(e).classList.remove(t):document.querySelector(e).classList.add(t)}function c(e,t){let s=+sessionStorage.getItem("money");sessionStorage.setItem("money",s-e),setTimeout((()=>{document.querySelector(t).classList.add("_delete-money"),document.querySelector(t).textContent=sessionStorage.getItem("money")}),500),setTimeout((()=>{document.querySelector(t).classList.remove("_delete-money")}),1500)}function r(e){document.querySelector(e).classList.add("_no-money"),setTimeout((()=>{document.querySelector(e).classList.remove("_no-money")}),1e3)}function n(){return+sessionStorage.getItem("current-bet")}function l(e,t){setTimeout((()=>{document.querySelector(t).textContent=+sessionStorage.getItem("money")+e,document.querySelector(t).classList.add("_anim-add-money"),sessionStorage.setItem("money",+sessionStorage.getItem("money")+e)}),2e3)}document.addEventListener("click",(e=>{let _=e.target;if(_.closest(".acces-preloader__button")&&(sessionStorage.setItem("preloader",!0),t.classList.add("_hide"),s.classList.add("_visible")),_.closest(".footer__minus")){let e=+sessionStorage.getItem("current-bet");e>50&&(sessionStorage.setItem("current-bet",e-50),document.querySelector(".footer__coins").textContent=sessionStorage.getItem("current-bet"))}if(_.closest(".footer__plus")){let e=+sessionStorage.getItem("current-bet");+sessionStorage.getItem("money")>e&&(sessionStorage.setItem("current-bet",e+50),document.querySelector(".footer__coins").textContent=sessionStorage.getItem("current-bet"))}_.closest(".footer__button_bet")&&(+sessionStorage.getItem("money")>=+sessionStorage.getItem("current-bet")?(o(".footer__button_bet","_hold"),o(".footer__controls","_hold"),c(n(),".check"),u(),setTimeout((()=>{var e,t;(function(e){let t=n();e>=0&&e<=19?(m(3,3,3),l(.01*t,".check"),i(.01*t,.01),a(1)):e>=20&&e<=23?(m(3,3,4),l(2*t,".check"),i(2*t,2),a(2)):e>=24&&e<=26?(m(3,3,1),l(5*t,".check"),i(5*t,5),a(3)):e>=27&&e<=29?(m(3,3,5),l(10*t,".check"),i(10*t,10),a(4)):e>=30&&e<=31?(m(3,3,2),l(15*t,".check"),i(15*t,15),a(5)):e>=32&&e<=33?(m(3,2,1),l(32*t,".check"),i(32*t,32),a(6)):34==e?(m(4,2,1),l(42*t,".check"),i(42*t,42),a(7)):35==e?(m(1,5,4),l(53*t,".check"),i(53*t,53),a(8)):36==e&&(m(2,5,4),l(60*t,".check"),i(60*t,60),a(9))})((e=0,t=36,Math.floor(Math.random()*(t-e)+e))),setTimeout((()=>{document.querySelector(".win").classList.add("_active")}),2e3)}),1e3)):r(".check")),_.closest(".win__button_play")&&(document.querySelector(".win").classList.remove("_active"),u(),o(".footer__button_bet","_hold"),o(".footer__controls","_hold"),document.querySelectorAll(".block-mini-game__box").forEach((e=>{e.dataset.level&&e.classList.remove("_selected")}))),document.querySelector(".shop")&&document.querySelector(".shop").classList.contains("_active")&&!_.closest(".shop__body")&&document.querySelector(".shop").classList.remove("_active"),(_.closest(".bonuses__count_bomb")||_.closest(".bonuses__count_anvil")||_.closest(".bonuses__count_circle"))&&document.querySelector(".shop").classList.add("_active"),_.closest(".bonuses__button_bomb")&&(+sessionStorage.getItem("money")>=3500?(c(3500,".check"),sessionStorage.setItem("bonus-bomb",+sessionStorage.getItem("bonus-bomb")+1),d("bomb")):r(".check")),_.closest(".bonuses__button_anvil")&&(+sessionStorage.getItem("money")>=5500?(c(5500,".check"),sessionStorage.setItem("bonus-anvil",+sessionStorage.getItem("bonus-anvil")+1),d("anvil")):r(".check")),_.closest(".bonuses__button_circle")&&(+sessionStorage.getItem("money")>=7500?(c(7500,".check"),sessionStorage.setItem("bonus-circle",+sessionStorage.getItem("bonus-circle")+1),d("circle")):r(".check")),_.closest(".bonuses__bomb")&&!_.closest(".bonuses__count_bomb")&&0!=+sessionStorage.getItem("bonus-bomb")&&(sessionStorage.setItem("bonus-bomb",+sessionStorage.getItem("bonus-bomb")-1),d("bomb")),_.closest(".bonuses__anvil")&&!_.closest(".bonuses__count_anvil")&&0!=+sessionStorage.getItem("bonus-anvil")&&(sessionStorage.setItem("bonus-anvil",+sessionStorage.getItem("bonus-anvil")-1),d("anvil")),_.closest(".bonuses__circle")&&!_.closest(".bonuses__count_circle")&&0!=+sessionStorage.getItem("bonus-circle")&&(sessionStorage.setItem("bonus-circle",+sessionStorage.getItem("bonus-circle")-1),d("circle"))}));function m(e,t,s){let o=document.createElement("img"),c=document.createElement("img"),r=document.createElement("img");o.setAttribute("src",`img/mini-game/crystall-${e}.png`),c.setAttribute("src",`img/mini-game/crystall-${t}.png`),r.setAttribute("src",`img/mini-game/crystall-${s}.png`),document.querySelector(".crystalls__item_1").append(o),document.querySelector(".crystalls__item_1").classList.add(`_bg-${e}`),setTimeout((()=>{document.querySelector(".crystalls__item_2").append(c),document.querySelector(".crystalls__item_2").classList.add(`_bg-${t}`)}),500),setTimeout((()=>{document.querySelector(".crystalls__item_3").append(r),document.querySelector(".crystalls__item_3").classList.add(`_bg-${s}`)}),1e3)}function i(e,t){document.querySelector(".win__text").textContent=e,document.querySelector(".win__rate").textContent=`x${t}`}function a(e){setTimeout((()=>{document.querySelectorAll(".block-mini-game__box").forEach((t=>{t.dataset.level==e&&t.classList.add("_selected")}))}),1200)}function u(){document.querySelector(".crystalls__item_1 img")&&(document.querySelector(".crystalls__item_1 img").remove(),document.querySelector(".crystalls__item_2 img").remove(),document.querySelector(".crystalls__item_3 img").remove(),document.querySelector(".crystalls__item_1").classList.contains("_bg-1")?document.querySelector(".crystalls__item_1").classList.remove("_bg-1"):document.querySelector(".crystalls__item_1").classList.contains("_bg-2")&&document.querySelector(".crystalls__item_1").classList.remove("_bg-2"),document.querySelector(".crystalls__item_1").classList.contains("_bg-3")&&document.querySelector(".crystalls__item_1").classList.remove("_bg-3"),document.querySelector(".crystalls__item_1").classList.contains("_bg-4")&&document.querySelector(".crystalls__item_1").classList.remove("_bg-4"),document.querySelector(".crystalls__item_1").classList.contains("_bg-5")&&document.querySelector(".crystalls__item_1").classList.remove("_bg-5"),document.querySelector(".crystalls__item_2").classList.contains("_bg-1")?document.querySelector(".crystalls__item_2").classList.remove("_bg-1"):document.querySelector(".crystalls__item_2").classList.contains("_bg-2")&&document.querySelector(".crystalls__item_2").classList.remove("_bg-2"),document.querySelector(".crystalls__item_2").classList.contains("_bg-3")&&document.querySelector(".crystalls__item_2").classList.remove("_bg-3"),document.querySelector(".crystalls__item_2").classList.contains("_bg-4")&&document.querySelector(".crystalls__item_2").classList.remove("_bg-4"),document.querySelector(".crystalls__item_2").classList.contains("_bg-5")&&document.querySelector(".crystalls__item_2").classList.remove("_bg-5"),document.querySelector(".crystalls__item_3").classList.contains("_bg-1")?document.querySelector(".crystalls__item_3").classList.remove("_bg-1"):document.querySelector(".crystalls__item_3").classList.contains("_bg-2")&&document.querySelector(".crystalls__item_3").classList.remove("_bg-2"),document.querySelector(".crystalls__item_3").classList.contains("_bg-3")&&document.querySelector(".crystalls__item_3").classList.remove("_bg-3"),document.querySelector(".crystalls__item_3").classList.contains("_bg-4")&&document.querySelector(".crystalls__item_3").classList.remove("_bg-4"),document.querySelector(".crystalls__item_3").classList.contains("_bg-5")&&document.querySelector(".crystalls__item_3").classList.remove("_bg-5"))}function d(e){0==+sessionStorage.getItem(`bonus-${e}`)?document.querySelector(`.bonuses__count_${e}`).textContent="+":document.querySelector(`.bonuses__count_${e}`).textContent=sessionStorage.getItem(`bonus-${e}`)}let _={containerColorBG:"#353336",contentColorBG:"#525053",countRows:6,countCols:5,offsetBorder:10,borderRadius:8,gemSize:64,imagesCoin:["img/game/game-img-1.png","img/game/game-img-2.png","img/game/game-img-3.png","img/game/game-img-4.png"],gemClass:"gem",gemIdPrefix:"gem",gameStates:["pick","switch","revert","remove","refill"],gameState:"",movingItems:0,countScore:0},g={selectedRow:-1,selectedCol:-1,posX:"",posY:""},y={container:document.createElement("div"),content:document.createElement("div"),wrapper:document.createElement("div"),cursor:document.createElement("div"),score:document.createElement("div"),gems:new Array};function S(e,t,s,o,c){let r=document.createElement("div");r.classList.add(_.gemClass),r.id=_.gemIdPrefix+"_"+s+"_"+o,r.style.position="absolute",r.style.top=e+"px",r.style.left=t+"px",r.style.width=_.gemSize+"px",r.style.height=_.gemSize+"px",r.style.border="1p solid transparent",r.style.backgroundImage="url("+c+")",r.style.backgroundSize="100%",y.wrapper.append(r)}function b(e,t){return p(e,t)||f(e,t)}function p(e,t){let s=y.gems[e][t],o=0,c=e;for(;c>0&&y.gems[c-1][t]==s;)o++,c--;for(c=e;c<_.countRows-1&&y.gems[c+1][t]==s;)o++,c++;return o>1}function f(e,t){let s=y.gems[e][t],o=0,c=t;for(;c>0&&y.gems[e][c-1]==s;)o++,c--;for(c=t;c<_.countCols-1&&y.gems[e][c+1]==s;)o++,c++;return o>1}function q(){let e=g.selectedRow-g.posY,t=g.selectedCol-g.posX;document.querySelector("#"+_.gemIdPrefix+"_"+g.selectedRow+"_"+g.selectedCol).classList.add("switch"),document.querySelector("#"+_.gemIdPrefix+"_"+g.selectedRow+"_"+g.selectedCol).setAttribute("dir","-1"),document.querySelector("#"+_.gemIdPrefix+"_"+g.posY+"_"+g.posX).classList.add("switch"),document.querySelector("#"+_.gemIdPrefix+"_"+g.posY+"_"+g.posX).setAttribute("dir","1"),$(".switch").each((function(){_.movingItems++,$(this).animate({left:"+="+t*_.gemSize*$(this).attr("dir"),top:"+="+e*_.gemSize*$(this).attr("dir")},{duration:250,complete:function(){v()}}),$(this).removeClass("switch")})),document.querySelector("#"+_.gemIdPrefix+"_"+g.selectedRow+"_"+g.selectedCol).setAttribute("id","temp"),document.querySelector("#"+_.gemIdPrefix+"_"+g.posY+"_"+g.posX).setAttribute("id",_.gemIdPrefix+"_"+g.selectedRow+"_"+g.selectedCol),document.querySelector("#temp").setAttribute("id",_.gemIdPrefix+"_"+g.posY+"_"+g.posX);let s=y.gems[g.selectedRow][g.selectedCol];y.gems[g.selectedRow][g.selectedCol]=y.gems[g.posY][g.posX],y.gems[g.posY][g.posX]=s}function v(){if(_.movingItems--,0==_.movingItems)switch(_.gameState){case _.gameStates[1]:case _.gameStates[2]:b(g.selectedRow,g.selectedCol)||b(g.posY,g.posX)?(_.gameState=_.gameStates[3],b(g.selectedRow,g.selectedCol)&&I(g.selectedRow,g.selectedCol),b(g.posY,g.posX)&&I(g.posY,g.posX),h()):_.gameState!=_.gameStates[2]?(_.gameState=_.gameStates[2],q()):(_.gameState=_.gameStates[0],g.selectedRow=-1,g.selectedCol=-1);break;case _.gameStates[3]:L();break;case _.gameStates[4]:!function(){let e=0;for(let t=0;t<_.countCols;t++)-1==y.gems[0][t]&&(y.gems[0][t]=Math.floor(3*Math.random()+0),S(0,t*_.gemSize,0,t,_.imagesCoin[y.gems[0][t]]),e++);if(e)_.gameState=_.gameStates[3],L();else{let e=0;for(let t=0;t<_.countRows;t++)for(let s=0;s<_.countCols;s++)s<=_.countCols-3&&y.gems[t][s]==y.gems[t][s+1]&&y.gems[t][s]==y.gems[t][s+2]&&(e++,I(t,s)),t<=_.countRows-3&&y.gems[t][s]==y.gems[t+1][s]&&y.gems[t][s]==y.gems[t+2][s]&&(e++,I(t,s));e>0?(_.gameState=_.gameStates[3],h()):(_.gameState=_.gameStates[0],g.selectedRow=-1)}}()}}function I(e,t){let s=y.gems[e][t],o=e;document.querySelector("#"+_.gemIdPrefix+"_"+e+"_"+t).classList.add("remove");let c=document.querySelectorAll(".remove").length;if(p(e,t)){for(;o>0&&y.gems[o-1][t]==s;)document.querySelector("#"+_.gemIdPrefix+"_"+(o-1)+"_"+t).classList.add("remove"),y.gems[o-1][t]=-1,o--,c++;for(o=e;o<_.countRows-1&&y.gems[o+1][t]==s;)document.querySelector("#"+_.gemIdPrefix+"_"+(o+1)+"_"+t).classList.add("remove"),y.gems[o+1][t]=-1,o++,c++}if(f(e,t)){for(o=t;o>0&&y.gems[e][o-1]==s;)document.querySelector("#"+_.gemIdPrefix+"_"+e+"_"+(o-1)).classList.add("remove"),y.gems[e][o-1]=-1,o--,c++;for(o=t;o<_.countCols-1&&y.gems[e][o+1]==s;)document.querySelector("#"+_.gemIdPrefix+"_"+e+"_"+(o+1)).classList.add("remove"),y.gems[e][o+1]=-1,o++,c++}var r;y.gems[e][t]=-1,(r=c)>=4?r*=2:r>=5?r=2*(r+1):r>=6&&(r*=2*(r+2)),_.countScore+=r,l(r,".check"),console.log(_.countScore)}function h(){$(".remove").each((function(){_.movingItems++,$(this).animate({opacity:0},{duration:200,complete:function(){$(this).remove(),v()}})}))}function L(){let e=0;for(let t=0;t<_.countCols;t++)for(let s=_.countRows-1;s>0;s--)-1==y.gems[s][t]&&y.gems[s-1][t]>=0&&(document.querySelector("#"+_.gemIdPrefix+"_"+(s-1)+"_"+t).classList.add("fall"),document.querySelector("#"+_.gemIdPrefix+"_"+(s-1)+"_"+t).setAttribute("id",_.gemIdPrefix+"_"+s+"_"+t),y.gems[s][t]=y.gems[s-1][t],y.gems[s-1][t]=-1,e++);$(".fall").each((function(){_.movingItems++,$(this).animate({top:"+="+_.gemSize},{duration:100,complete:function(){$(this).removeClass("fall"),v()}})})),0==e&&(_.gameState=_.gameStates[4],_.movingItems=1,v())}document.body.style.margin="0px",y.content.style.padding=_.offsetBorder+"px",y.content.style.width=_.gemSize*_.countCols+2*_.offsetBorder+"px",y.content.style.height=_.gemSize*_.countRows+2*_.offsetBorder+"px",document.querySelector(".block-game__field").append(y.content),y.wrapper.style.position="relative",y.wrapper.style.height="100%",y.wrapper.addEventListener("click",(function(e){!function(e,t){if(t.classList.contains(_.gemClass)&&_.gameStates[0]){let e=parseInt(t.getAttribute("id").split("_")[1]),s=parseInt(t.getAttribute("id").split("_")[2]);y.cursor.style.display="block",y.cursor.style.top=parseInt(t.style.top)+"px",y.cursor.style.left=parseInt(t.style.left)+"px",-1==g.selectedRow?(g.selectedRow=e,g.selectedCol=s):1==Math.abs(g.selectedRow-e)&&g.selectedCol==s||1==Math.abs(g.selectedCol-s)&&g.selectedRow==e?(y.cursor.style.display="none",_.gameState=_.gameStates[1],g.posX=s,g.posY=e,q()):(g.selectedRow=e,g.selectedCol=s)}}(0,e.target)})),y.content.append(y.wrapper),y.cursor.id="marker",y.cursor.style.width=_.gemSize+"px",y.cursor.style.height=_.gemSize+"px",y.cursor.style.border="2px solid white",y.cursor.style.borderRadius="5px",y.cursor.style.position="absolute",y.cursor.style.zIndex="1",y.cursor.style.display="none",y.wrapper.append(y.cursor),function(){for(let e=0;e<_.countRows;e++){y.gems[e]=new Array;for(let t=0;t<_.countCols;t++)y.gems[e][t]=-1}for(let e=0;e<_.countRows;e++)for(let t=0;t<_.countCols;t++){do{y.gems[e][t]=Math.floor(3*Math.random()+0)}while(b(e,t));S(e*_.gemSize,t*_.gemSize,e,t,_.imagesCoin[y.gems[e][t]])}}(),_.gameState=_.gameStates[0],window.FLS=!0,function(e){let t=new Image;t.onload=t.onerror=function(){e(2==t.height)},t.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA"}((function(e){let t=!0===e?"webp":"no-webp";document.documentElement.classList.add(t)}))})();