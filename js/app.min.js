(()=>{"use strict";let e=!1;setTimeout((()=>{if(e){let e=new Event("windowScroll");window.addEventListener("scroll",(function(t){document.dispatchEvent(e)}))}}),0),window.addEventListener("load",(function(){document.querySelector("body")&&setTimeout((function(){document.querySelector("body").classList.add("_loaded")}),200)})),sessionStorage.getItem("preloader")&&(document.querySelector(".preloader")&&document.querySelector(".preloader").classList.add("_hide"),document.querySelector(".wrapper").classList.add("_visible")),sessionStorage.getItem("money")||sessionStorage.setItem("money",1e3),document.querySelector(".check").textContent=sessionStorage.getItem("money"),document.querySelector(".game")&&(d("bomb"),d("anvil"),d("circle")),document.querySelector(".mini-game")&&(document.querySelector(".footer__coins").textContent=50,sessionStorage.setItem("current-bet",50));const t=document.querySelector(".preloader"),s=document.querySelector(".wrapper");function o(e,t){document.querySelector(e).classList.contains(t)?document.querySelector(e).classList.remove(t):document.querySelector(e).classList.add(t)}function c(e,t){let s=+sessionStorage.getItem("money");sessionStorage.setItem("money",s-e),setTimeout((()=>{document.querySelector(t).classList.add("_delete-money"),document.querySelector(t).textContent=sessionStorage.getItem("money")}),500),setTimeout((()=>{document.querySelector(t).classList.remove("_delete-money")}),1500)}function n(e){document.querySelector(e).classList.add("_no-money"),setTimeout((()=>{document.querySelector(e).classList.remove("_no-money")}),1e3)}function m(){return+sessionStorage.getItem("current-bet")}function r(e,t,s,o){setTimeout((()=>{document.querySelector(t).textContent=+sessionStorage.getItem("money")+e,document.querySelector(t).classList.add("_anim-add-money"),sessionStorage.setItem("money",+sessionStorage.getItem("money")+e)}),s),setTimeout((()=>{document.querySelector(t).classList.remove("_anim-add-money")}),o)}function l(){var e,t;!function(e){let t=m();e>=0&&e<=19?(i(3,3,3),r(.01*t,".check",2500,3500),a(.01*t,.01),u(1)):e>=20&&e<=23?(i(3,3,4),r(2*t,".check",2500,3500),a(2*t,2),u(2)):e>=24&&e<=26?(i(3,3,1),r(5*t,".check",2500,3500),a(5*t,5),u(3)):e>=27&&e<=29?(i(3,3,5),r(10*t,".check",2500,3500),a(10*t,10),u(4)):e>=30&&e<=31?(i(3,3,2),r(15*t,".check",2500,3500),a(15*t,15),u(5)):e>=32&&e<=33?(i(3,2,1),r(32*t,".check",2500,3500),a(32*t,32),u(6)):34==e?(i(4,2,1),r(42*t,".check",2500,3500),a(42*t,42),u(7)):35==e?(i(1,5,4),r(53*t,".check",2500,3500),a(53*t,53),u(8)):36==e&&(i(2,5,4),r(60*t,".check",2500,3500),a(60*t,60),u(9))}((e=0,t=36,Math.floor(Math.random()*(t-e)+e))),setTimeout((()=>{document.querySelector(".win").classList.add("_active")}),2e3)}function i(e,t,s){let o=document.createElement("img"),c=document.createElement("img"),n=document.createElement("img");o.setAttribute("src",`img/mini-game/crystall-${e}.png`),c.setAttribute("src",`img/mini-game/crystall-${t}.png`),n.setAttribute("src",`img/mini-game/crystall-${s}.png`),document.querySelector(".crystalls__item_1").append(o),document.querySelector(".crystalls__item_1").classList.add(`_bg-${e}`),setTimeout((()=>{document.querySelector(".crystalls__item_2").append(c),document.querySelector(".crystalls__item_2").classList.add(`_bg-${t}`)}),500),setTimeout((()=>{document.querySelector(".crystalls__item_3").append(n),document.querySelector(".crystalls__item_3").classList.add(`_bg-${s}`)}),1e3)}function a(e,t){document.querySelector(".win__text").textContent=e,document.querySelector(".win__rate").textContent=`x${t}`}function u(e){setTimeout((()=>{document.querySelectorAll(".block-mini-game__box").forEach((t=>{t.dataset.level==e&&t.classList.add("_selected")}))}),1200)}function _(){document.querySelector(".crystalls__item_1 img")&&(document.querySelector(".crystalls__item_1 img").remove(),document.querySelector(".crystalls__item_2 img").remove(),document.querySelector(".crystalls__item_3 img").remove(),document.querySelector(".crystalls__item_1").classList.contains("_bg-1")?document.querySelector(".crystalls__item_1").classList.remove("_bg-1"):document.querySelector(".crystalls__item_1").classList.contains("_bg-2")&&document.querySelector(".crystalls__item_1").classList.remove("_bg-2"),document.querySelector(".crystalls__item_1").classList.contains("_bg-3")&&document.querySelector(".crystalls__item_1").classList.remove("_bg-3"),document.querySelector(".crystalls__item_1").classList.contains("_bg-4")&&document.querySelector(".crystalls__item_1").classList.remove("_bg-4"),document.querySelector(".crystalls__item_1").classList.contains("_bg-5")&&document.querySelector(".crystalls__item_1").classList.remove("_bg-5"),document.querySelector(".crystalls__item_2").classList.contains("_bg-1")?document.querySelector(".crystalls__item_2").classList.remove("_bg-1"):document.querySelector(".crystalls__item_2").classList.contains("_bg-2")&&document.querySelector(".crystalls__item_2").classList.remove("_bg-2"),document.querySelector(".crystalls__item_2").classList.contains("_bg-3")&&document.querySelector(".crystalls__item_2").classList.remove("_bg-3"),document.querySelector(".crystalls__item_2").classList.contains("_bg-4")&&document.querySelector(".crystalls__item_2").classList.remove("_bg-4"),document.querySelector(".crystalls__item_2").classList.contains("_bg-5")&&document.querySelector(".crystalls__item_2").classList.remove("_bg-5"),document.querySelector(".crystalls__item_3").classList.contains("_bg-1")?document.querySelector(".crystalls__item_3").classList.remove("_bg-1"):document.querySelector(".crystalls__item_3").classList.contains("_bg-2")&&document.querySelector(".crystalls__item_3").classList.remove("_bg-2"),document.querySelector(".crystalls__item_3").classList.contains("_bg-3")&&document.querySelector(".crystalls__item_3").classList.remove("_bg-3"),document.querySelector(".crystalls__item_3").classList.contains("_bg-4")&&document.querySelector(".crystalls__item_3").classList.remove("_bg-4"),document.querySelector(".crystalls__item_3").classList.contains("_bg-5")&&document.querySelector(".crystalls__item_3").classList.remove("_bg-5"))}function d(e){0==+sessionStorage.getItem(`bonus-${e}`)?document.querySelector(`.bonuses__count_${e}`).textContent="+":document.querySelector(`.bonuses__count_${e}`).textContent=sessionStorage.getItem(`bonus-${e}`)}let g={countRows:6,countCols:5,offsetBorder:10,borderRadius:8,gemSize:63,imagesCoin:["img/game/game-img-1.png","img/game/game-img-2.png","img/game/game-img-3.png","img/game/game-img-4.png"],gemClass:"gem",gemIdPrefix:"gem",gameStates:["pick","switch","revert","remove","refill"],gameState:"",movingItems:0,countScore:0,count_move:0,crystall_cord_x:null,crystall_cord_y:null},y={selectedRow:-1,selectedCol:-1,posX:"",posY:""},S={container:document.createElement("div"),content:document.createElement("div"),wrapper:document.createElement("div"),cursor:document.createElement("div"),score:document.createElement("div"),gems:new Array};function b(e,t){g.gameState=g.gameStates[1],y.posX=e,y.posY=t,L()}function f(e){e>=4?e*=2:e>=5?e=2*(e+1):e>=6&&(e*=2*(e+2)),g.countScore+=e,r(e,".check",500,1500),console.log(g.countScore),g.countScore>=3e3&&setTimeout((()=>{var e;document.querySelector(".win").classList.add("_active"),e=1,document.querySelector(".win__level").textContent=e,document.querySelector(".win__text_game").textContent=g.countScore}),1e3)}function v(e,t,s,o,c){let n=document.createElement("div");n.classList.add(g.gemClass),n.id=`${g.gemIdPrefix}_${s}_${o}`,n.style.top=`${e}px`,n.style.left=`${t}px`,n.style.backgroundImage=`url('${c}')`,S.wrapper.append(n)}function p(e,t){return I(e,t)||q(e,t)}function I(e,t){let s=S.gems[e][t],o=0,c=e;for(;c>0&&S.gems[c-1][t]==s;)o++,c--;for(c=e;c<g.countRows-1&&S.gems[c+1][t]==s;)o++,c++;return o>1}function q(e,t){let s=S.gems[e][t],o=0,c=t;for(;c>0&&S.gems[e][c-1]==s;)o++,c--;for(c=t;c<g.countCols-1&&S.gems[e][c+1]==s;)o++,c++;return o>1}function L(){let e=y.selectedRow-y.posY,t=y.selectedCol-y.posX;document.querySelector("#"+g.gemIdPrefix+"_"+y.selectedRow+"_"+y.selectedCol).classList.add("switch"),document.querySelector("#"+g.gemIdPrefix+"_"+y.selectedRow+"_"+y.selectedCol).setAttribute("dir","-1"),document.querySelector("#"+g.gemIdPrefix+"_"+y.posY+"_"+y.posX).classList.add("switch"),document.querySelector("#"+g.gemIdPrefix+"_"+y.posY+"_"+y.posX).setAttribute("dir","1"),$(".switch").each((function(){g.movingItems++,$(this).animate({left:"+="+t*g.gemSize*$(this).attr("dir"),top:"+="+e*g.gemSize*$(this).attr("dir")},{duration:250,complete:function(){h()}}),$(this).removeClass("switch")})),document.querySelector("#"+g.gemIdPrefix+"_"+y.selectedRow+"_"+y.selectedCol).setAttribute("id","temp"),document.querySelector("#"+g.gemIdPrefix+"_"+y.posY+"_"+y.posX).setAttribute("id",g.gemIdPrefix+"_"+y.selectedRow+"_"+y.selectedCol),document.querySelector("#temp").setAttribute("id",g.gemIdPrefix+"_"+y.posY+"_"+y.posX);let s=S.gems[y.selectedRow][y.selectedCol];S.gems[y.selectedRow][y.selectedCol]=S.gems[y.posY][y.posX],S.gems[y.posY][y.posX]=s}function h(){if(g.movingItems--,0==g.movingItems)switch(g.gameState){case g.gameStates[1]:case g.gameStates[2]:p(y.selectedRow,y.selectedCol)||p(y.posY,y.posX)?(g.gameState=g.gameStates[3],p(y.selectedRow,y.selectedCol)&&w(y.selectedRow,y.selectedCol),p(y.posY,y.posX)&&w(y.posY,y.posX),C()):g.gameState!=g.gameStates[2]?(g.gameState=g.gameStates[2],L()):(g.gameState=g.gameStates[0],y.selectedRow=-1,y.selectedCol=-1);break;case g.gameStates[3]:x();break;case g.gameStates[4]:!function(){let e=0;for(let t=0;t<g.countCols;t++)-1==S.gems[0][t]&&(S.gems[0][t]=Math.floor(3*Math.random()+0),v(0,t*g.gemSize,0,t,g.imagesCoin[S.gems[0][t]]),e++);if(e)g.gameState=g.gameStates[3],x();else{let e=0;for(let t=0;t<g.countRows;t++)for(let s=0;s<g.countCols;s++)s<=g.countCols-3&&S.gems[t][s]==S.gems[t][s+1]&&S.gems[t][s]==S.gems[t][s+2]&&(e++,w(t,s)),t<=g.countRows-3&&S.gems[t][s]==S.gems[t+1][s]&&S.gems[t][s]==S.gems[t+2][s]&&(e++,w(t,s));e>0?(g.gameState=g.gameStates[3],C()):(g.gameState=g.gameStates[0],y.selectedRow=-1)}}()}}function w(e,t){let s=S.gems[e][t],o=e;document.querySelector("#"+g.gemIdPrefix+"_"+e+"_"+t).classList.add("remove");let c=document.querySelectorAll(".remove").length;if(I(e,t)){for(;o>0&&S.gems[o-1][t]==s;)document.querySelector("#"+g.gemIdPrefix+"_"+(o-1)+"_"+t).classList.add("remove"),S.gems[o-1][t]=-1,o--,c++;for(o=e;o<g.countRows-1&&S.gems[o+1][t]==s;)document.querySelector("#"+g.gemIdPrefix+"_"+(o+1)+"_"+t).classList.add("remove"),S.gems[o+1][t]=-1,o++,c++}if(q(e,t)){for(o=t;o>0&&S.gems[e][o-1]==s;)document.querySelector("#"+g.gemIdPrefix+"_"+e+"_"+(o-1)).classList.add("remove"),S.gems[e][o-1]=-1,o--,c++;for(o=t;o<g.countCols-1&&S.gems[e][o+1]==s;)document.querySelector("#"+g.gemIdPrefix+"_"+e+"_"+(o+1)).classList.add("remove"),S.gems[e][o+1]=-1,o++,c++}S.gems[e][t]=-1,f(c)}function C(){$(".remove").each((function(){g.movingItems++,$(this).animate({opacity:0},{duration:200,complete:function(){$(this).remove(),h()}})}))}function x(){let e=0;for(let t=0;t<g.countCols;t++)for(let s=g.countRows-1;s>0;s--)-1==S.gems[s][t]&&S.gems[s-1][t]>=0&&(document.querySelector("#"+g.gemIdPrefix+"_"+(s-1)+"_"+t).classList.add("fall"),document.querySelector("#"+g.gemIdPrefix+"_"+(s-1)+"_"+t).setAttribute("id",g.gemIdPrefix+"_"+s+"_"+t),S.gems[s][t]=S.gems[s-1][t],S.gems[s-1][t]=-1,e++);$(".fall").each((function(){g.movingItems++,$(this).animate({top:"+="+g.gemSize},{duration:100,complete:function(){$(this).removeClass("fall"),h()}})})),0==e&&(g.gameState=g.gameStates[4],g.movingItems=1,h())}document.addEventListener("touchstart",(function(e){let t=e.target;if(g.count_move=0,t.closest(".gem")){let s=parseInt(t.getAttribute("id").split("_")[1]),o=parseInt(t.getAttribute("id").split("_")[2]);y.selectedRow=s,y.selectedCol=o,g.crystall_cord_x=e.touches[0].clientX,g.crystall_cord_y=e.touches[0].clientY}}),!1),document.addEventListener("touchend",(function(){setTimeout((()=>{y.selectedRow=-1,y.selectedCol=-1}),500)}),!1),document.addEventListener("touchmove",(function(e){if(g.count_move>=1)return!1;g.count_move++;let t=e.touches[0].clientX,s=e.touches[0].clientY,o=t-g.crystall_cord_x,c=s-g.crystall_cord_y,n=y.selectedRow,m=y.selectedCol;Math.abs(o)>Math.abs(c)?b(o>0?m+1:m-1,n):b(m,c>0?n+1:n-1)}),!1),document.querySelector(".game")&&(S.content.style.width=g.gemSize*g.countCols+2*g.offsetBorder+"px",S.content.style.height=g.gemSize*g.countRows+2*g.offsetBorder+"px",document.querySelector(".block-game__field").append(S.content),S.wrapper.classList.add("block-game__wrapper"),S.wrapper.classList.add("_pin"),S.content.append(S.wrapper),function(){for(let e=0;e<g.countRows;e++){S.gems[e]=new Array;for(let t=0;t<g.countCols;t++)S.gems[e][t]=-1}for(let e=0;e<g.countRows;e++)for(let t=0;t<g.countCols;t++){do{S.gems[e][t]=Math.floor(3*Math.random()+0)}while(p(e,t));v(e*g.gemSize,t*g.gemSize,e,t,g.imagesCoin[S.gems[e][t]])}}(),g.gameState=g.gameStates[0]),document.addEventListener("click",(e=>{let r=e.target;if(r.closest(".acces-preloader__button")&&(sessionStorage.setItem("preloader",!0),t.classList.add("_hide"),s.classList.add("_visible")),r.closest(".footer__minus")){let e=+sessionStorage.getItem("current-bet");e>50&&(sessionStorage.setItem("current-bet",e-50),document.querySelector(".footer__coins").textContent=sessionStorage.getItem("current-bet"))}if(r.closest(".footer__plus")){let e=+sessionStorage.getItem("current-bet");+sessionStorage.getItem("money")>e&&(sessionStorage.setItem("current-bet",e+50),document.querySelector(".footer__coins").textContent=sessionStorage.getItem("current-bet"))}if(r.closest(".footer__button_bet")&&(+sessionStorage.getItem("money")>=+sessionStorage.getItem("current-bet")?(o(".footer__button_bet","_hold"),o(".footer__controls","_hold"),c(m(),".check"),_(),setTimeout((()=>{l()}),1e3)):n(".check")),r.closest(".win__button_play")&&(document.querySelector(".win").classList.remove("_active"),_(),o(".footer__button_bet","_hold"),o(".footer__controls","_hold"),document.querySelectorAll(".block-mini-game__box").forEach((e=>{e.dataset.level&&e.classList.remove("_selected")}))),document.querySelector(".shop")&&document.querySelector(".shop").classList.contains("_active")&&!r.closest(".shop__body")&&document.querySelector(".shop").classList.remove("_active"),(r.closest(".bonuses__count_bomb")||r.closest(".bonuses__count_anvil")||r.closest(".bonuses__count_circle"))&&document.querySelector(".shop").classList.add("_active"),r.closest(".bonuses__button_bomb")&&(+sessionStorage.getItem("money")>=3500?(c(3500,".check"),sessionStorage.setItem("bonus-bomb",+sessionStorage.getItem("bonus-bomb")+1),d("bomb")):n(".check")),r.closest(".bonuses__button_anvil")&&(+sessionStorage.getItem("money")>=5500?(c(5500,".check"),sessionStorage.setItem("bonus-anvil",+sessionStorage.getItem("bonus-anvil")+1),d("anvil")):n(".check")),r.closest(".bonuses__button_circle")&&(+sessionStorage.getItem("money")>=7500?(c(7500,".check"),sessionStorage.setItem("bonus-circle",+sessionStorage.getItem("bonus-circle")+1),d("circle")):n(".check")),r.closest(".bonuses__bomb")&&!r.closest(".bonuses__count_bomb")&&0!=+sessionStorage.getItem("bonus-bomb")&&(sessionStorage.setItem("bonus-bomb",+sessionStorage.getItem("bonus-bomb")-1),d("bomb"),r.closest(".bonuses__bomb").classList.add("_anim")),r.closest(".bonuses__anvil")&&!r.closest(".bonuses__count_anvil")&&0!=+sessionStorage.getItem("bonus-anvil")&&(sessionStorage.setItem("bonus-anvil",+sessionStorage.getItem("bonus-anvil")-1),d("anvil"),r.closest(".bonuses__anvil").classList.add("_anim")),r.closest(".bonuses__circle")&&!r.closest(".bonuses__count_circle")&&0!=+sessionStorage.getItem("bonus-circle")&&(sessionStorage.setItem("bonus-circle",+sessionStorage.getItem("bonus-circle")-1),d("circle"),r.closest(".bonuses__circle").classList.add("_anim")),r.closest(".block-game__wrapper")&&document.querySelector(".bonuses__bomb").classList.contains("_anim")){!function(e){g.movingItems++,document.querySelector(".bonuses__bomb").classList.remove("_anim");let t,s,o,c,n,m,r,l,i,a,u,_,d,y,S,b,f=parseInt(e.getAttribute("id").split("_")[1]),v=parseInt(e.getAttribute("id").split("_")[2]);0!=f&&(t=f-1,s=v),f>=2&&(o=f-2,c=v),f<=4&&(n=f+1,m=v),f<=3&&(r=f+2,l=v),v<4&&(i=f,a=v+1),v<3&&(u=f,_=v+2),0!=v&&(d=f,y=v-1),v>=2&&(S=f,b=v-2),document.getElementById(`gem_${t}_${s}`)&&(w(t,s),document.getElementById(`gem_${t}_${s}`).remove()),document.getElementById(`gem_${o}_${c}`)&&(w(o,c),document.getElementById(`gem_${o}_${c}`).remove()),document.getElementById(`gem_${n}_${m}`)&&(w(n,m),document.getElementById(`gem_${n}_${m}`).remove()),document.getElementById(`gem_${r}_${l}`)&&(w(r,l),document.getElementById(`gem_${r}_${l}`).remove()),document.getElementById(`gem_${d}_${y}`)&&(w(d,y),document.getElementById(`gem_${d}_${y}`).remove()),document.getElementById(`gem_${S}_${b}`)&&(w(S,b),document.getElementById(`gem_${S}_${b}`).remove()),document.getElementById(`gem_${i}_${a}`)&&(w(i,a),document.getElementById(`gem_${i}_${a}`).remove()),document.getElementById(`gem_${u}_${_}`)&&(w(u,_),document.getElementById(`gem_${u}_${_}`).remove()),g.gameState=g.gameStates[3],h()}(r.closest(".gem"))}if(r.closest(".block-game__wrapper")&&document.querySelector(".bonuses__anvil").classList.contains("_anim")){!function(e){g.movingItems++,document.querySelector(".bonuses__anvil").classList.remove("_anim");let t=parseInt(e.getAttribute("id").split("_")[1]);w(t,0),document.getElementById(`gem_${t}_0`).remove(),w(t,1),document.getElementById(`gem_${t}_1`).remove(),w(t,2),document.getElementById(`gem_${t}_2`).remove(),w(t,3),document.getElementById(`gem_${t}_3`).remove(),w(t,4),document.getElementById(`gem_${t}_4`).remove(),g.gameState=g.gameStates[3],h()}(r.closest(".gem"))}if(r.closest(".block-game__wrapper")&&document.querySelector(".bonuses__circle").classList.contains("_anim")){!function(e){g.movingItems++,document.querySelector(".bonuses__circle").classList.remove("_anim");let t=parseInt(e.getAttribute("id").split("_")[1]),s=parseInt(e.getAttribute("id").split("_")[2]),o=S.gems[t][s];for(let e=0;e<S.gems.length;e++)for(let t=0;t<S.gems[e].length;t++)S.gems[e][t]==o&&(w(e,t),document.getElementById(`gem_${e}_${t}`).remove());g.gameState=g.gameStates[3],h()}(r.closest(".gem"))}})),window.FLS=!0,function(e){let t=new Image;t.onload=t.onerror=function(){e(2==t.height)},t.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA"}((function(e){let t=!0===e?"webp":"no-webp";document.documentElement.classList.add(t)}))})();